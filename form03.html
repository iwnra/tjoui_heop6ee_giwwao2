<!DOCTYPE HTML>
<html>
    <head>
        <meta charset="UTF-8">
        <title>テスト</title>
        <link href="https://use.fontawesome.com/releases/v6.4.0/css/all.css" rel="stylesheet">
        <style type="text/css">
            body {
                background-color:#9dcbf1;
            }
            .title {
                color:#134d9e;
                text-align:center;
            }
            .que {
                color:#0041cc;
            }
            table {
                border-collapse: collapse;
            }
            button {
                width: 80px;
                color: white;
                background-color: rgb(43, 193, 9);
                border: solid 1px rgb(43, 193, 9);
                border-radius: 5px;
                box-shadow: 5px 5px 5px 0 rgba(0, 0, 0, 0.3);
            }
            button:hover {
                background-color: rgb(31, 132, 8);
                border: solid 1px rgb(31, 132, 8);
            }
            .header {
                background-color: #0041cc;
                color: white;
            }
            .fas {
                color: white;
            }
            .fas:hover {
                color: grey;
            }
            .tablearea1 {
                height: 200px;
                width: 843px;
                overflow-y: auto;
            }
            .table2 {
                background-color: white;
            }
            .table2 th, .table2 td {
                border: solid 1px black;
            }
            .table2 tr:nth-child(1) td {
                border-top: none;
            }
        </style>

    </head>

    <body>
        <div class="header">
            <a href=""><i class="fas fa-sharp fa-light fa-house"></i></a>
            <span>一覧表</span>
        </div>
    
        <form method="post" action="http://xxx.xxx.xxx/xxx/xxx.cgi" name="mail_form" onSubmit="javascript:return Nul_Check()">

            <table class="table1">
                <tr>
                    <th class="que">名前</th>
                    <td><input type="text" name="name"></td>
                </tr>
                <tr>
                    <th class="que">住所</th>
                    <td><input type="text" name="address"></td>
                </tr>
                <tr>
                    <th class="que">性別</th>
                    <td>
                        <input type="radio" name="sex" value="male">男性
                        <input type="radio" name="sex" value="female">女性
                    </td>
                </tr>
                <tr>
                    <th class="que">地域</th>
                    <td class="ans">
                        <select name="area">
                            <option value="">--- 選択してください ---</option>
                            <option value="hokkaido">北海道</option>
                            <option value="tohoku">東北</option>
                            <option value="kanto">関東</option>
                            <option value="hokuriku">北陸</option>
                            <option value="chubu">中部</option>
                            <option value="kansai">関西</option>
                            <option value="sikoku">四国</option>
                            <option value="kyusyu">九州</option>
                            <option value="okinawa">沖縄</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <th class="que">種類</th>
                    <td class="ans">
                        <label><input type="checkbox" name="fine" value="design">デザイン</label>
                        <input type="checkbox" name="fine" value="illust">イラスト
                        <input type="checkbox" name="fine" value="photo">写真
                        <input type="checkbox" name="fine" value="diary">日記
                    </td>
                </tr>
                <tr>
                    <th class="que">備考</th>
                    <td><textarea name="impression" cols="50" rows="10"></textarea></td>
                </tr>
                <tr>
                    <td colspan="4" align="center">
                        <button type="submit">送信</button>
                        <button type="reset">リセット</button>
                    </td>
                </tr>
            </table>
        </form>
        <br><br>

        
        <form class="">
            <div>新しい行を追加：<input type="button" id="add" name="add" value="追加" onclick="appendRow()"></div>
            <div>チェック行の削除：<input type="button" id="del" name="del" value="削除" onclick="deleteRow()"></div><br>
            <table class="table2">
                <tr>    
                    <th width="100px">カラム名１</th>
                    <th width="100px">カラム名２</th>
                    <th width="100px">カラム名３</th>
                    <th width="100px">カラム名４</th>
                    <th width="100px">カラム名５</th>
                    <th width="100px">カラム名６</th>
                    <th width="100px">カラム名７</th>
                    <th width="100px">カラム名８</th>
                </tr> 
            </table>
            <div class="tablearea1">
                <table class="table2" id="tb2">
                    <tr id="tr1">
                        <td width="100px"><span>1</span></td>
                        <td width="100px"><span contenteditable="true">セル１</span></td>
                        <td width="100px"><span contenteditable="true">セル２</span></td>
                        <td width="100px"><span contenteditable="true">セル３</span></td>
                        <td width="100px"><span contenteditable="true">セル４</span></td>
                        <td width="100px"><span contenteditable="true">セル５</span></td>
                        <td width="100px"><span contenteditable="true">セル６</span></td>
                        <td width="100px"><input type="checkbox" name="DeleteName[]" value="1" id="cb_tr1" onchange="foo('tr1');"></td>
                    </tr>
                    <tr>
                        <td width="306px" colspan="3"><span contenteditable="true">合計</span></td>
                        <td width="100px"><span contenteditable="true">セル４</span></td>
                        <td width="100px"><span contenteditable="true">セル５</span></td>
                        <td width="100px"><span contenteditable="true">セル６</span></td>
                        <td width="100px"><span contenteditable="true">セル７</span></td>
                        <td width="100px"></td>
                    </tr>
                </table>
            </div>
        </form>

        <script>
            /*
            * foo: チェックを入れた行の背景色を変更
            */
            function foo(num) {
                if (document.getElementById("cb_" + num).checked) {
                    document.getElementById(num).style.backgroundColor='#cccccc';

                } else {
                    document.getElementById(num).style.backgroundColor='white';
                }
            }

            /*
            * appendRow: テーブルに行を追加する処理
            */
            function appendRow()
            {
                var objTBL = document.getElementById("tb2");
                if (!objTBL)
                    return;
                
                // 行数をカウント
                var count = objTBL.rows.length;
                
                // 合計行の上に新しい行を追加
                var row = objTBL.insertRow(count -1);
                var num = "'tr" + count + "'";
                row.setAttribute("id","tr" + count);

                // 追加した行にセルを挿入
                var c1 = row.insertCell(0);
                var c2 = row.insertCell(1);
                var c3 = row.insertCell(2);
                var c4 = row.insertCell(3);
                var c5 = row.insertCell(4);
                var c6 = row.insertCell(5);
                var c7 = row.insertCell(6);
                var c8 = row.insertCell(7);

                // セルにスタイルを設定
                c1.style.cssText = "width:100px;";
                c2.style.cssText = "width:100px;";
                c3.style.cssText = "width:100px;";
                c4.style.cssText = "width:100px;";
                c5.style.cssText = "width:100px;";
                c6.style.cssText = "width:100px;";
                c7.style.cssText = "width:100px;";
                c8.style.cssText = "width:100px;";
                
                // セルの表示内容を設定（<td>内）
                c1.innerHTML = '<span class="seqno">' + count + '</span>';
                c2.innerHTML = '<span contenteditable="true">' + 'セル１' + '</span>';
                c3.innerHTML = '<span contenteditable="true">' + 'セル２' + '</span>';
                c4.innerHTML = '<span contenteditable="true">' + 'セル３' + '</span>';
                c5.innerHTML = '<span contenteditable="true">' + 'セル４' + '</span>';
                c6.innerHTML = '<span contenteditable="true">' + 'セル５' + '</span>';
                c7.innerHTML = '<span contenteditable="true">' + 'セル６' + '</span>';
                c8.innerHTML = '<input type="checkbox" name="DeleteName[]" value="' + count + '" id="cb_tr' + count + '" onchange="foo(' + num + ');">'              
            }

            /*
            * deleteRow: チェックを入れた行の削除処理
            */
            function deleteRow() {
                const checkedList = document.querySelectorAll(".table2 [name='DeleteName[]']:checked");
                if (checkedList.length === 0) {
                    alert("選択してください");
                    return;
                }
                if(!confirm("削除しますか？")) {
                    return;
                } 
                checkedList.forEach(check => check.closest("tr").remove());

                // <span> 行番号ふり直し
                var tagElements = document.getElementsByTagName("span");
                if (!tagElements)
                    return false;

                var seq = 2;
                for (var i = 0; i < tagElements.length; i++) {
                    if (tagElements[i].className.match("seqno"))
                        tagElements[i].innerHTML = seq++;
                }
            }

            // var table = document.querySelector("#tb2");
            // var tr = table.querySelectorAll("tr");
            // table.addEventListener("click", function(e) {
            //     //clickされたのがtd要素のとき、
            //     if(e.target.tagName.toLowerCase() === "td") {
            //         for(var i = 0; i < tr.length; i++) {
            //             //一旦全てのtr要素の背景色を白にし、
            //             tr[i].style.backgroundColor = 'white';
            //         }
            //         //clickされたtd要素の親であるtr要素のみ背景色を赤にする
            //         e.target.parentNode.style.backgroundColor = "red";
            //     }
            // }, false);
           
        </script>

    </body>
</html>
